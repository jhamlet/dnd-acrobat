!function e(t,n,r){function i(o,a){if(!n[o]){if(!t[o]){var s="function"==typeof require&&require;if(!a&&s)return s(o,!0);if(u)return u(o,!0);throw new Error("Cannot find module '"+o+"'")}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[o].exports}for(var u="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t){function n(e){n.superclass.call(this,u.reduce(function(e,t){return e[t.name]=i.extend({score:0,bonus:0},t),e},{parent:e})),e.once("init",this.init.bind(this))}var r=e("./model"),i=e("underscore"),u=[{name:"strength",abbr:"Str"},{name:"dexterity",abbr:"Dex"},{name:"constitution",abbr:"Con"},{name:"intelligence",abbr:"Int"},{name:"wisdom",abbr:"Wis"},{name:"charisma",abbr:"Cha"}];t.exports=r.extend(n,{get keys(){return u.map(i.property("name"))},init:function(){var e=this.updateScore.bind(this),t=this.onScoreBlurred.bind(this);this.on("score-changed",this.onScoreChanged.bind(this)),this.on("bonus-changed",this.onBonusChanged.bind(this)),u.forEach(function(n){var r=n.abbr,i=n.name,u=document.getField(r+"Score"),o=t.bind(null,i);e(i,u.value),document.on(r+"Score","blur",o)}),this.init=i.noop},updateBonus:function(e,t){var n=this[e],r=n.bonus;r!==t&&(n.bonus=t,this.emit("bonus-changed",e,t))},updateScore:function(e,t){var n=this[e],r=n.score;t=parseInt(t,10),t!==r&&(n.score=t,this.emit("score-changed",e,t))},onScoreChanged:function(e,t){var n=Math.floor((t-10)/2);this.updateBonus(e,n)},onBonusChanged:function(e,t){var n=i.where(u,{name:e})[0].abbr,r=document.getField(n+"Mod");r.value=(t>=0?"+":"-")+Math.abs(t)},onScoreBlurred:function(e,t){var n=t.target;this.updateScore(e,n.value)}})},{"./model":11,underscore:25}],2:[function(e,t){function n(){n.superclass.call(this,{abilities:new i(this),classes:new u(this),saves:new o(this),skills:new a(this)}),this.emit("init")}var r=e("./model"),i=e("./abilities"),u=e("./classes"),o=e("./saves"),a=e("./skills");t.exports=r.extend(n)},{"./abilities":1,"./classes":3,"./model":11,"./saves":12,"./skills":13}],3:[function(e,t){function n(e){n.superclass.call(this,{parent:e,_value:"",_classes:[],proficiency:0}),e.once("init",this.init.bind(this))}var r=e("./model"),i=/([\w-]+)\s*(\d+)/g;t.exports=r.extend(n,{init:function(){document.on("ClassLevel","blur",this.onClassLevelBlurred.bind(this)),this.on("changed",this.updateProficiencyBonus.bind(this)),this.on("proficiency-bonus",function(e){document.getField("ProfBonus").value=(e>=0?"+":"-")+e}),this.onClassLevelBlurred({target:document.getField("ClassLevel")})},updateClassLevel:function(e){var t=this._classes;t.length=0,e.replace(i,function(e,n,r){t.push({name:n,level:parseInt(r,10)})}),this.emit("changed",t.reduce(function(e,t){return e[t.name]=t.level,e.total+=t.level,e},{total:0}))},updateProficiencyBonus:function(e){var t=e.total,n=this.proficiency,r=Math.ceil(t/4)+1;r!==n&&(this.proficiency=r,this.emit("proficiency-bonus",r))},onClassLevelBlurred:function(e){var t=e.target,n=this._value,r=t.value;r!==n&&(this._value=r,this.updateClassLevel(r))}})},{"./model":11}],4:[function(e,t,n){var r=e("protean"),i=e("events").EventEmitter,u=e("underscore"),o={enter:"MouseEnter",leave:"MouseExit",press:"MouseDown",click:"MouseUp",focus:"OnFocus",blur:"OnBlur",keyup:"Keystroke",validate:"Validate",format:"Format",calculate:"Calculate"};document=n,r.augment(document,{_elements:{},_doc:event.target,_get:function(e){var t;return this._elements[e]?this._elements[e]:(t=this._doc.getField(e),t&&this.initField(t))},getField:function(e){var t=this._get(e);return t&&t.field},emit:function(e){var t=event.target,n=t.name,r=this.getEmitter(n);r&&r.emit(e,event)},on:function(e,t,n){var r=this.initEvent(this._get(e),t);r&&r.emitter.on(t,n)},removeListener:function(e,t,n){var r=this._get(e);r&&r.removeListener(t,n)},getEmitter:function(e){var t=this._get(e);return t&&t.emitter},initField:function(e){var t=e.name,n=this._elements[t];return n||(n=this._elements[t]={emitter:new i,field:e,actions:u.keys(o).reduce(function(e,t){return e[t]=!1,e},{})}),n},initEvent:function(e,t){return e&&!e.actions[t]&&(e.actions[t]=!0,e.field.setAction(o[t],"document.emit('"+t+"');")),e},resetField:function(e){u.keys(o).forEach(function(t){e.setAction(o[t],"")})},resetElement:function(e){e.emitter.removeAllListeners(),e.emitter=null,this.resetField(e.field),e.actions=null},reset:function(){var e=this._elements;u.keys(e).map(u.pick.bind(u,e)).forEach(this.resetElement.bind(this)),this._elements={}}})},{events:14,protean:21,underscore:25}],5:[function(){var e=Array.prototype;"function"!=typeof e.map&&(e.map=function(e,t){for(var n,r,i=this,u=i.length,o=0,a=[];u>o;o++)n=i[o],r=e.call(t||null,n,o,i),a.push(r);return a}),"function"!=typeof e.forEach&&(e.forEach=e.each=function(e,t){this.map(e,t)}),"function"!=typeof e.filter&&(e.filter=function(e,t){var n=[];return this.map(function(r,i,u){e.call(t||null,r,i,u)&&n.push(r)}),n}),e.reduce||(e.reduce=function(e){var t,n=Object(this),r=n.length,i=0;if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");if(2===arguments.length)t=arguments[1];else{for(;r>i&&!(i in n);)i++;if(i>=r)throw new TypeError("Reduce of empty array with no initial value");t=n[i++]}for(;r>i;i++)i in n&&(t=e(t,n[i],i,n));return t})},{}],6:[function(e,t){var n="undefined"!=typeof n?n:{},r=e("underscore");n.log||(n.log=n.println?r.bind(n.println,n):"function"==typeof alert?alert:function(){},n.log("Console extensions loaded")),t.exports=n},{underscore:25}],7:[function(){var e=Function.prototype,t=Array.prototype.slice;"function"!=typeof e.bind&&(e.bind=function(e){var n=t.call(arguments,1),r=this;return function(){return r.apply(e,n.concat(t.call(arguments)))}})},{}],8:[function(e){e("./function"),e("./object"),e("./array"),e("./console")},{"./array":5,"./console":6,"./function":7,"./object":9}],9:[function(){var e;"function"!=typeof Object.keys&&(Object.keys=function(e){var t,n=[];for(t in e)n.push(t);return n}),Object.defineProperty||(Object.defineProperty=function(e,t,n){var r=n.value,i=n.get,u=n.set;return i||u?(i&&e.__defineGetter__(t,i),u&&e.__defineSetter__(t,u)):e[t]=r,e}),Object.defineProperties||(Object.defineProperties=function(e,t){var n;for(n in t)Object.defineProperty(e,n,t[n]);return e}),Object.create||(e=function(){},Object.create=function(t,n){var r;return e.prototype=t,r=new e,n&&Object.defineProperties(r,n),r})},{}],10:[function(e){e("./ext"),e("./document");var t=e("./character");character=new t},{"./character":2,"./document":4,"./ext":8}],11:[function(e,t){function n(e){n.superclass.call(this),r.augment(this,e||{})}var r=e("protean"),i=e("events").EventEmitter;t.exports=r.inherit(i,n)},{events:14,protean:21}],12:[function(e,t){function n(e){n.superclass.call(this,{parent:e}),e.once("init",this.init.bind(this))}var r=e("./model");t.exports=r.extend(n,{init:function(){var e=this.parent,t=e.abilities,n=this.update.bind(this);t.on("bonus-changed",n),e.classes.on("proficiency-bonus",this.updateAll.bind(this)),t.keys.forEach(function(r){var i=e.abilities[r].abbr,u=i+"SaveProf";document.on(u,"click",function(){n(r,t[r].bonus)})}),this.updateAll()},updateAll:function(){var e=this.parent.abilities,t=this.update.bind(this);e.keys.forEach(function(n){t(n,e[n].bonus)})},update:function(e,t){var n=this.parent.abilities[e].abbr,r=document.getField(n+"SaveProf"),i=document.getField(n+"Save"),u=r.isBoxChecked(0),o=this.parent.classes.proficiency||0,a=t+(u?o:0);i.value=(a>=0?"+":"-")+a,this.emit("changed",e,a)}})},{"./model":11}],13:[function(e,t){function n(e){n.superclass.call(this,i.keys(u).map(function(e){return i.extend({name:e},u[e])}).reduce(function(e,t){return e[t.name]=i.extend({total:0},t),e},{parent:e})),e.once("init",this.init.bind(this))}var r=e("./model"),i=e("underscore"),u={Acrobatics:{ability:"dexterity"},AnimalHandling:{ability:"wisdom"},Arcana:{ability:"intelligence"},Athletics:{ability:"strength"},Deception:{ability:"charisma"},History:{ability:"intelligence"},Insight:{ability:"wisdom"},Intimidation:{ability:"charisma"},Investigation:{ability:"intelligence"},Medicine:{ability:"wisdom"},Nature:{ability:"intelligence"},Perception:{ability:"wisdom"},Performance:{ability:"charisma"},Persuasion:{ability:"charisma"},Religion:{ability:"intelligence"},SleightOfHand:{ability:"dexterity"},Stealth:{ability:"dexterity"},Survival:{ability:"wisdom"}};t.exports=r.extend(n,{get keys(){return i.keys(u)},init:function(){var e=this.parent,t=e.abilities,n=this.keys,r=this.update.bind(this);e.classes.on("proficiency-bonus",this.updateAll.bind(this)),t.on("bonus-changed",function(e,t){n.forEach(function(n){u[n].ability===e&&r(n,t)})}),this.keys.forEach(function(e){var n=e+"Prof";document.on(n,"click",function(){r(e,t[u[e].ability].bonus)})}),this.updateAll()},updateAll:function(){var e=this.parent.abilities,t=this.update.bind(this);this.keys.forEach(function(n){var r=u[n].ability;t(n,e[r].bonus)})},update:function(e,t){var n=document.getField(e+"Prof"),r=document.getField(e),i=n.isBoxChecked(0),u=this.parent.classes.proficiency||0,o=this[e],a=o&&o.total,s=t+(i?u:0);return r?void((""===r.value||a!==s)&&(this[e].total=s,r.value=(s>=0?"+":"-")+s,this.emit("changed",e,s))):void console.println("COULD NOT LOCATE SKILL FIELD: "+e)}})},{"./model":11,underscore:25}],14:[function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function u(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,a,s,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],o(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,a=new Array(i-1),s=1;i>s;s++)a[s-1]=arguments[s];n.apply(this,a)}else if(u(n)){for(i=arguments.length,a=new Array(i-1),s=1;i>s;s++)a[s-1]=arguments[s];for(c=n.slice(),i=c.length,s=0;i>s;s++)c[s].apply(this,a)}return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?u(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u(this._events[e])&&!this._events[e].warned){var i;i=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,o,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(u(n)){for(a=o;a-->0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],15:[function(e,t){function n(){return r.rest(arguments,1).reduce(function(e,t){var n,r,u,o;for(n in t)e.hasOwnProperty(n)||(r=i&&t.__lookupGetter__(n),u=i&&t.__lookupSetter__(n),r||u?(o=o||{},o[n]={get:r,set:u,configurable:!0,enumerable:!0}):e[n]=t[n]);return o&&Object.defineProperties(e,o),e},arguments[0])}var r=e("underscore"),i=Boolean(Object.prototype.__lookupGetter__);t.exports=n},{underscore:25}],16:[function(e,t){t.exports=e("./inherit").bind(null,Object)},{"./inherit":22}],17:[function(e,t){var n=e("underscore");t.exports=function(){return n.reduce(arguments,function(e,t,n){return e[t]=n+1,e},{})}},{underscore:25}],18:[function(e,t){function n(){var e=i.flatten(i.rest(arguments,0)).reduce(function(e,t){var n;return i.isFunction(t)?(n={},n.fn=t,e.push(n)):(n=e[e.length-1],n.args=n.args||[null],n.args.push(t)),e},[]).map(function(e){return r.apply(e.fn,e.args)});return function(){for(var t,n=i.rest(arguments,0),r=e.length,u=0;r>u;u++)t=e[u],n=t[i.isArray(n)?"apply":"call"](null,n);return n}}var r=Function.prototype.bind,i=e("underscore");t.exports=n},{underscore:25}],19:[function(e,t){for(var n=[],r=0;256>r;r++)n[r]=(16>r?"0":"")+r.toString(16);t.exports=function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return n[255&e]+n[e>>8&255]+n[e>>16&255]+n[e>>24&255]+"-"+n[255&t]+n[t>>8&255]+"-"+n[t>>16&15|64]+n[t>>24&255]+"-"+n[63&r|128]+n[r>>8&255]+"-"+n[r>>16&255]+n[r>>24&255]+n[255&i]+n[i>>8&255]+n[i>>16&255]+n[i>>24&255]}},{}],20:[function(e,t){var n=e("underscore");t.exports=function(){var e=n.rest(arguments,0);return n.object(e,e)}},{underscore:25}],21:[function(e,t){t.exports={inherit:e("./inherit"),classify:e("./classify"),augment:e("./augment"),hashify:e("./hashify"),enumerate:e("./enumerate"),instantiate:e("./instantiate"),guid:e("./guid"),invoke:e("./invoke"),execute:e("./execute")}},{"./augment":15,"./classify":16,"./enumerate":17,"./execute":18,"./guid":19,"./hashify":20,"./inherit":22,"./instantiate":23,"./invoke":24}],22:[function(e,t){function n(e,t,u,o){var a,s,c;return arguments.length<4&&"function"!=typeof t&&(o=u,u=t,t=null),a=u&&u.hasOwnProperty("constructor"),t="function"==typeof t&&t||a&&u.constructor||function(){e.apply(this,arguments)},s=e.prototype,t.prototype=c=r(Object.create(s),t.prototype),o=o||{},u&&(delete u.constructor,r(c,u)),o.constructor={value:t},Object.defineProperties(c,o),t.superclass=e,t.superproto=s,t.extend||(t.extend=n.bind(t,t)),t.extended=t.extended?i.wrap(t.extended.bind(t),function(t,n){e.extended&&e.extended(n),t(n)}):e.extended,e.extended&&e.extended(t),t}var r=e("./augment"),i=e("underscore");t.exports=n},{"./augment":15,underscore:25}],23:[function(e,t){e("underscore");t.exports=function(e,t){var n=Object.create(e.prototype);return e.apply(n,t||[]),n}},{underscore:25}],24:[function(e,t){function n(e){var t=r.rest(arguments,1);return function(n){return n[e].apply(n,t)}}var r=e("underscore");t.exports=n},{underscore:25}],25:[function(e,t,n){(function(){var e=this,r=e._,i=Array.prototype,u=Object.prototype,o=Function.prototype,a=i.push,s=i.slice,c=i.concat,l=u.toString,f=u.hasOwnProperty,h=Array.isArray,p=Object.keys,v=o.bind,d=function(e){return e instanceof d?e:this instanceof d?void(this._wrapped=e):new d(e)};"undefined"!=typeof n?("undefined"!=typeof t&&t.exports&&(n=t.exports=d),n._=d):e._=d,d.VERSION="1.7.0";var m=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,u){return e.call(t,n,r,i,u)}}return function(){return e.apply(t,arguments)}};d.iteratee=function(e,t,n){return null==e?d.identity:d.isFunction(e)?m(e,t,n):d.isObject(e)?d.matches(e):d.property(e)},d.each=d.forEach=function(e,t,n){if(null==e)return e;t=m(t,n);var r,i=e.length;if(i===+i)for(r=0;i>r;r++)t(e[r],r,e);else{var u=d.keys(e);for(r=0,i=u.length;i>r;r++)t(e[u[r]],u[r],e)}return e},d.map=d.collect=function(e,t,n){if(null==e)return[];t=d.iteratee(t,n);for(var r,i=e.length!==+e.length&&d.keys(e),u=(i||e).length,o=Array(u),a=0;u>a;a++)r=i?i[a]:a,o[a]=t(e[r],r,e);return o};var g="Reduce of empty array with no initial value";d.reduce=d.foldl=d.inject=function(e,t,n,r){null==e&&(e=[]),t=m(t,r,4);var i,u=e.length!==+e.length&&d.keys(e),o=(u||e).length,a=0;if(arguments.length<3){if(!o)throw new TypeError(g);n=e[u?u[a++]:a++]}for(;o>a;a++)i=u?u[a]:a,n=t(n,e[i],i,e);return n},d.reduceRight=d.foldr=function(e,t,n,r){null==e&&(e=[]),t=m(t,r,4);var i,u=e.length!==+e.length&&d.keys(e),o=(u||e).length;if(arguments.length<3){if(!o)throw new TypeError(g);n=e[u?u[--o]:--o]}for(;o--;)i=u?u[o]:o,n=t(n,e[i],i,e);return n},d.find=d.detect=function(e,t,n){var r;return t=d.iteratee(t,n),d.some(e,function(e,n,i){return t(e,n,i)?(r=e,!0):void 0}),r},d.filter=d.select=function(e,t,n){var r=[];return null==e?r:(t=d.iteratee(t,n),d.each(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r)},d.reject=function(e,t,n){return d.filter(e,d.negate(d.iteratee(t)),n)},d.every=d.all=function(e,t,n){if(null==e)return!0;t=d.iteratee(t,n);var r,i,u=e.length!==+e.length&&d.keys(e),o=(u||e).length;for(r=0;o>r;r++)if(i=u?u[r]:r,!t(e[i],i,e))return!1;return!0},d.some=d.any=function(e,t,n){if(null==e)return!1;t=d.iteratee(t,n);var r,i,u=e.length!==+e.length&&d.keys(e),o=(u||e).length;for(r=0;o>r;r++)if(i=u?u[r]:r,t(e[i],i,e))return!0;return!1},d.contains=d.include=function(e,t){return null==e?!1:(e.length!==+e.length&&(e=d.values(e)),d.indexOf(e,t)>=0)},d.invoke=function(e,t){var n=s.call(arguments,2),r=d.isFunction(t);return d.map(e,function(e){return(r?t:e[t]).apply(e,n)})},d.pluck=function(e,t){return d.map(e,d.property(t))},d.where=function(e,t){return d.filter(e,d.matches(t))},d.findWhere=function(e,t){return d.find(e,d.matches(t))},d.max=function(e,t,n){var r,i,u=-1/0,o=-1/0;if(null==t&&null!=e){e=e.length===+e.length?e:d.values(e);for(var a=0,s=e.length;s>a;a++)r=e[a],r>u&&(u=r)}else t=d.iteratee(t,n),d.each(e,function(e,n,r){i=t(e,n,r),(i>o||i===-1/0&&u===-1/0)&&(u=e,o=i)});return u},d.min=function(e,t,n){var r,i,u=1/0,o=1/0;if(null==t&&null!=e){e=e.length===+e.length?e:d.values(e);for(var a=0,s=e.length;s>a;a++)r=e[a],u>r&&(u=r)}else t=d.iteratee(t,n),d.each(e,function(e,n,r){i=t(e,n,r),(o>i||1/0===i&&1/0===u)&&(u=e,o=i)});return u},d.shuffle=function(e){for(var t,n=e&&e.length===+e.length?e:d.values(e),r=n.length,i=Array(r),u=0;r>u;u++)t=d.random(0,u),t!==u&&(i[u]=i[t]),i[t]=n[u];return i},d.sample=function(e,t,n){return null==t||n?(e.length!==+e.length&&(e=d.values(e)),e[d.random(e.length-1)]):d.shuffle(e).slice(0,Math.max(0,t))},d.sortBy=function(e,t,n){return t=d.iteratee(t,n),d.pluck(d.map(e,function(e,n,r){return{value:e,index:n,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return e.index-t.index}),"value")};var y=function(e){return function(t,n,r){var i={};return n=d.iteratee(n,r),d.each(t,function(r,u){var o=n(r,u,t);e(i,r,o)}),i}};d.groupBy=y(function(e,t,n){d.has(e,n)?e[n].push(t):e[n]=[t]}),d.indexBy=y(function(e,t,n){e[n]=t}),d.countBy=y(function(e,t,n){d.has(e,n)?e[n]++:e[n]=1}),d.sortedIndex=function(e,t,n,r){n=d.iteratee(n,r,1);for(var i=n(t),u=0,o=e.length;o>u;){var a=u+o>>>1;n(e[a])<i?u=a+1:o=a}return u},d.toArray=function(e){return e?d.isArray(e)?s.call(e):e.length===+e.length?d.map(e,d.identity):d.values(e):[]},d.size=function(e){return null==e?0:e.length===+e.length?e.length:d.keys(e).length},d.partition=function(e,t,n){t=d.iteratee(t,n);var r=[],i=[];return d.each(e,function(e,n,u){(t(e,n,u)?r:i).push(e)}),[r,i]},d.first=d.head=d.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:0>t?[]:s.call(e,0,t)},d.initial=function(e,t,n){return s.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},d.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},d.rest=d.tail=d.drop=function(e,t,n){return s.call(e,null==t||n?1:t)},d.compact=function(e){return d.filter(e,d.identity)};var b=function(e,t,n,r){if(t&&d.every(e,d.isArray))return c.apply(r,e);for(var i=0,u=e.length;u>i;i++){var o=e[i];d.isArray(o)||d.isArguments(o)?t?a.apply(r,o):b(o,t,n,r):n||r.push(o)}return r};d.flatten=function(e,t){return b(e,t,!1,[])},d.without=function(e){return d.difference(e,s.call(arguments,1))},d.uniq=d.unique=function(e,t,n,r){if(null==e)return[];d.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=d.iteratee(n,r));for(var i=[],u=[],o=0,a=e.length;a>o;o++){var s=e[o];if(t)o&&u===s||i.push(s),u=s;else if(n){var c=n(s,o,e);d.indexOf(u,c)<0&&(u.push(c),i.push(s))}else d.indexOf(i,s)<0&&i.push(s)}return i},d.union=function(){return d.uniq(b(arguments,!0,!0,[]))},d.intersection=function(e){if(null==e)return[];for(var t=[],n=arguments.length,r=0,i=e.length;i>r;r++){var u=e[r];if(!d.contains(t,u)){for(var o=1;n>o&&d.contains(arguments[o],u);o++);o===n&&t.push(u)}}return t},d.difference=function(e){var t=b(s.call(arguments,1),!0,!0,[]);return d.filter(e,function(e){return!d.contains(t,e)})},d.zip=function(e){if(null==e)return[];for(var t=d.max(arguments,"length").length,n=Array(t),r=0;t>r;r++)n[r]=d.pluck(arguments,r);return n},d.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},d.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=d.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}for(;i>r;r++)if(e[r]===t)return r;return-1},d.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=e.length;for("number"==typeof n&&(r=0>n?r+n+1:Math.min(r,n+1));--r>=0;)if(e[r]===t)return r;return-1},d.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=n||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),u=0;r>u;u++,e+=n)i[u]=e;return i};var _=function(){};d.bind=function(e,t){var n,r;if(v&&e.bind===v)return v.apply(e,s.call(arguments,1));if(!d.isFunction(e))throw new TypeError("Bind must be called on a function");return n=s.call(arguments,2),r=function(){if(!(this instanceof r))return e.apply(t,n.concat(s.call(arguments)));_.prototype=e.prototype;var i=new _;_.prototype=null;var u=e.apply(i,n.concat(s.call(arguments)));return d.isObject(u)?u:i}},d.partial=function(e){var t=s.call(arguments,1);return function(){for(var n=0,r=t.slice(),i=0,u=r.length;u>i;i++)r[i]===d&&(r[i]=arguments[n++]);for(;n<arguments.length;)r.push(arguments[n++]);return e.apply(this,r)}},d.bindAll=function(e){var t,n,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(t=1;r>t;t++)n=arguments[t],e[n]=d.bind(e[n],e);return e},d.memoize=function(e,t){var n=function(r){var i=n.cache,u=t?t.apply(this,arguments):r;return d.has(i,u)||(i[u]=e.apply(this,arguments)),i[u]};return n.cache={},n},d.delay=function(e,t){var n=s.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},d.defer=function(e){return d.delay.apply(d,[e,1].concat(s.call(arguments,1)))},d.throttle=function(e,t,n){var r,i,u,o=null,a=0;n||(n={});var s=function(){a=n.leading===!1?0:d.now(),o=null,u=e.apply(r,i),o||(r=i=null)};return function(){var c=d.now();a||n.leading!==!1||(a=c);var l=t-(c-a);return r=this,i=arguments,0>=l||l>t?(clearTimeout(o),o=null,a=c,u=e.apply(r,i),o||(r=i=null)):o||n.trailing===!1||(o=setTimeout(s,l)),u}},d.debounce=function(e,t,n){var r,i,u,o,a,s=function(){var c=d.now()-o;t>c&&c>0?r=setTimeout(s,t-c):(r=null,n||(a=e.apply(u,i),r||(u=i=null)))};return function(){u=this,i=arguments,o=d.now();var c=n&&!r;return r||(r=setTimeout(s,t)),c&&(a=e.apply(u,i),u=i=null),a}},d.wrap=function(e,t){return d.partial(t,e)},d.negate=function(e){return function(){return!e.apply(this,arguments)}},d.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},d.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},d.before=function(e,t){var n;return function(){return--e>0?n=t.apply(this,arguments):t=null,n}},d.once=d.partial(d.before,2),d.keys=function(e){if(!d.isObject(e))return[];if(p)return p(e);var t=[];for(var n in e)d.has(e,n)&&t.push(n);return t},d.values=function(e){for(var t=d.keys(e),n=t.length,r=Array(n),i=0;n>i;i++)r[i]=e[t[i]];return r},d.pairs=function(e){for(var t=d.keys(e),n=t.length,r=Array(n),i=0;n>i;i++)r[i]=[t[i],e[t[i]]];return r},d.invert=function(e){for(var t={},n=d.keys(e),r=0,i=n.length;i>r;r++)t[e[n[r]]]=n[r];return t},d.functions=d.methods=function(e){var t=[];for(var n in e)d.isFunction(e[n])&&t.push(n);return t.sort()},d.extend=function(e){if(!d.isObject(e))return e;for(var t,n,r=1,i=arguments.length;i>r;r++){t=arguments[r];for(n in t)f.call(t,n)&&(e[n]=t[n])}return e},d.pick=function(e,t,n){var r,i={};if(null==e)return i;if(d.isFunction(t)){t=m(t,n);for(r in e){var u=e[r];t(u,r,e)&&(i[r]=u)}}else{var o=c.apply([],s.call(arguments,1));e=new Object(e);for(var a=0,l=o.length;l>a;a++)r=o[a],r in e&&(i[r]=e[r])}return i},d.omit=function(e,t,n){if(d.isFunction(t))t=d.negate(t);else{var r=d.map(c.apply([],s.call(arguments,1)),String);t=function(e,t){return!d.contains(r,t)}}return d.pick(e,t,n)},d.defaults=function(e){if(!d.isObject(e))return e;for(var t=1,n=arguments.length;n>t;t++){var r=arguments[t];for(var i in r)void 0===e[i]&&(e[i]=r[i])}return e},d.clone=function(e){return d.isObject(e)?d.isArray(e)?e.slice():d.extend({},e):e},d.tap=function(e,t){return t(e),e};var x=function(e,t,n,r){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof d&&(e=e._wrapped),t instanceof d&&(t=t._wrapped);var i=l.call(e);if(i!==l.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}if("object"!=typeof e||"object"!=typeof t)return!1;for(var u=n.length;u--;)if(n[u]===e)return r[u]===t;var o=e.constructor,a=t.constructor;if(o!==a&&"constructor"in e&&"constructor"in t&&!(d.isFunction(o)&&o instanceof o&&d.isFunction(a)&&a instanceof a))return!1;n.push(e),r.push(t);var s,c;if("[object Array]"===i){if(s=e.length,c=s===t.length)for(;s--&&(c=x(e[s],t[s],n,r)););}else{var f,h=d.keys(e);if(s=h.length,c=d.keys(t).length===s)for(;s--&&(f=h[s],c=d.has(t,f)&&x(e[f],t[f],n,r)););}return n.pop(),r.pop(),c};d.isEqual=function(e,t){return x(e,t,[],[])},d.isEmpty=function(e){if(null==e)return!0;if(d.isArray(e)||d.isString(e)||d.isArguments(e))return 0===e.length;for(var t in e)if(d.has(e,t))return!1;return!0},d.isElement=function(e){return!(!e||1!==e.nodeType)},d.isArray=h||function(e){return"[object Array]"===l.call(e)},d.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},d.each(["Arguments","Function","String","Number","Date","RegExp"],function(e){d["is"+e]=function(t){return l.call(t)==="[object "+e+"]"}}),d.isArguments(arguments)||(d.isArguments=function(e){return d.has(e,"callee")}),"function"!=typeof/./&&(d.isFunction=function(e){return"function"==typeof e||!1}),d.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},d.isNaN=function(e){return d.isNumber(e)&&e!==+e},d.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===l.call(e)},d.isNull=function(e){return null===e},d.isUndefined=function(e){return void 0===e},d.has=function(e,t){return null!=e&&f.call(e,t)},d.noConflict=function(){return e._=r,this},d.identity=function(e){return e},d.constant=function(e){return function(){return e}},d.noop=function(){},d.property=function(e){return function(t){return t[e]}},d.matches=function(e){var t=d.pairs(e),n=t.length;return function(e){if(null==e)return!n;e=new Object(e);for(var r=0;n>r;r++){var i=t[r],u=i[0];if(i[1]!==e[u]||!(u in e))return!1}return!0}},d.times=function(e,t,n){var r=Array(Math.max(0,e));t=m(t,n,1);for(var i=0;e>i;i++)r[i]=t(i);return r},d.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},d.now=Date.now||function(){return(new Date).getTime()};var w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},j=d.invert(w),k=function(e){var t=function(t){return e[t]},n="(?:"+d.keys(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(i,t):e}};d.escape=k(w),d.unescape=k(j),d.result=function(e,t){if(null==e)return void 0;var n=e[t];return d.isFunction(n)?e[t]():n};var E=0;d.uniqueId=function(e){var t=++E+"";return e?e+t:t},d.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,O={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\u2028|\u2029/g,F=function(e){return"\\"+O[e]};d.template=function(e,t,n){!t&&n&&(t=n),t=d.defaults({},t,d.templateSettings);var r=RegExp([(t.escape||A).source,(t.interpolate||A).source,(t.evaluate||A).source].join("|")+"|$","g"),i=0,u="__p+='";e.replace(r,function(t,n,r,o,a){return u+=e.slice(i,a).replace(L,F),i=a+t.length,n?u+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?u+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(u+="';\n"+o+"\n__p+='"),t}),u+="';\n",t.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{var o=new Function(t.variable||"obj","_",u)}catch(a){throw a.source=u,a}var s=function(e){return o.call(this,e,d)},c=t.variable||"obj";return s.source="function("+c+"){\n"+u+"}",s},d.chain=function(e){var t=d(e);return t._chain=!0,t};var S=function(e){return this._chain?d(e).chain():e};d.mixin=function(e){d.each(d.functions(e),function(t){var n=d[t]=e[t];d.prototype[t]=function(){var e=[this._wrapped];return a.apply(e,arguments),S.call(this,n.apply(d,e))}})},d.mixin(d),d.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];d.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],S.call(this,n)}}),d.each(["concat","join","slice"],function(e){var t=i[e];d.prototype[e]=function(){return S.call(this,t.apply(this._wrapped,arguments))}}),d.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return d})}).call(this)},{}]},{},[10]);