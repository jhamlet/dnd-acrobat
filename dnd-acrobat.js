!function e(t,n,r){function i(u,s){if(!n[u]){if(!t[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(o)return o(u,!0);throw new Error("Cannot find module '"+u+"'")}var c=n[u]={exports:{}};t[u][0].call(c.exports,function(e){var n=t[u][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(e,t){function n(e){n.superclass.call(this,o.reduce(function(e,t){return e[t.name]=i.extend({score:0,bonus:0},t),e},{parent:e})),e.once("init",this.init.bind(this))}var r=e("./model"),i=e("underscore"),o=[{name:"strength",abbr:"Str"},{name:"dexterity",abbr:"Dex"},{name:"constitution",abbr:"Con"},{name:"intelligence",abbr:"Int"},{name:"wisdom",abbr:"Wis"},{name:"charisma",abbr:"Cha"}];t.exports=r.extend(n,{get keys(){return o.map(i.property("name"))},init:function(){var e=this.updateScore.bind(this),t=this.onScoreBlurred.bind(this);this.on("score-changed",this.onScoreChanged.bind(this)),this.on("bonus-changed",this.onBonusChanged.bind(this)),o.forEach(function(n){var r=n.abbr,i=n.name,o=document.getField(r+"Score"),u=t.bind(null,i);e(i,o.value),document.on(r+"Score","blur",u)}),this.init=i.noop},updateBonus:function(e,t){var n=this[e],r=n.bonus;r!==t&&(n.bonus=t,this.emit("bonus-changed",e,t))},updateScore:function(e,t){var n=this[e],r=n.score;t=parseInt(t,10),t!==r&&(n.score=t,this.emit("score-changed",e,t))},onScoreChanged:function(e,t){var n=Math.floor((t-10)/2);this.updateBonus(e,n)},onBonusChanged:function(e,t){var n=i.where(o,{name:e})[0].abbr,r=document.getField(n+"Mod");r.value=(t>=0?"+":"-")+Math.abs(t)},onScoreBlurred:function(e,t){var n=t.target;this.updateScore(e,n.value)}})},{"./model":11,underscore:25}],2:[function(e,t){function n(){n.superclass.call(this,{abilities:new i(this),classes:new o(this),saves:new u(this),skills:new s(this)}),this.init()}var r=e("./model"),i=e("./abilities"),o=e("./classes"),u=e("./saves"),s=e("./skills");t.exports=r.extend(n,{init:function(){var e=this.updatePerception.bind(this);this.emit("init"),this.skills.on("changed",function(t,n){"perception"===t.toLowerCase()&&e(n)}),this.updatePerception(this.skills.Perception.total)},updatePerception:function(e){var t=document.getField("PassivePerception");t.value=10+e}})},{"./abilities":1,"./classes":3,"./model":11,"./saves":12,"./skills":13}],3:[function(e,t){function n(e){n.superclass.call(this,{parent:e,_value:"",_classes:[],proficiency:0}),e.once("init",this.init.bind(this))}var r=e("./model"),i=/([\w-]+)\s*(\d+)/g;t.exports=r.extend(n,{init:function(){document.on("ClassLevel","blur",this.onClassLevelBlurred.bind(this)),this.on("changed",this.updateProficiencyBonus.bind(this)),this.on("proficiency-bonus",function(e){document.getField("ProfBonus").value=(e>=0?"+":"-")+e}),this.onClassLevelBlurred({target:document.getField("ClassLevel")})},updateClassLevel:function(e){var t=this._classes;t.length=0,e.replace(i,function(e,n,r){t.push({name:n,level:parseInt(r,10)})}),this.emit("changed",t.reduce(function(e,t){return e[t.name]=t.level,e.total+=t.level,e},{total:0}))},updateProficiencyBonus:function(e){var t=e.total,n=this.proficiency,r=Math.ceil(t/4)+1;r!==n&&(this.proficiency=r,this.emit("proficiency-bonus",r))},onClassLevelBlurred:function(e){var t=e.target,n=this._value,r=t.value;r!==n&&(this._value=r,this.updateClassLevel(r))}})},{"./model":11}],4:[function(e,t,n){var r=e("protean"),i=e("events").EventEmitter,o=e("underscore"),u={enter:"MouseEnter",leave:"MouseExit",press:"MouseDown",click:"MouseUp",focus:"OnFocus",blur:"OnBlur",keyup:"Keystroke",validate:"Validate",format:"Format",calculate:"Calculate"};document=n,r.augment(document,{_elements:{},_doc:event.target,_get:function(e){var t;return this._elements[e]?this._elements[e]:(t=this._doc.getField(e),t&&this.initField(t))},getField:function(e){var t=this._get(e);return t&&t.field},emit:function(e){var t=event.target,n=t.name,r=this.getEmitter(n);r&&r.emit(e,event)},on:function(e,t,n){var r=this.initEvent(this._get(e),t);r&&r.emitter.on(t,n)},removeListener:function(e,t,n){var r=this._get(e);r&&r.removeListener(t,n)},getEmitter:function(e){var t=this._get(e);return t&&t.emitter},initField:function(e){var t=e.name,n=this._elements[t];return n||(n=this._elements[t]={emitter:new i,field:e,actions:o.keys(u).reduce(function(e,t){return e[t]=!1,e},{})}),n},initEvent:function(e,t){return e&&!e.actions[t]&&(e.actions[t]=!0,e.field.setAction(u[t],"document.emit('"+t+"');")),e},resetField:function(e){o.keys(u).forEach(function(t){e.setAction(u[t],"")})},resetElement:function(e){e.emitter.removeAllListeners(),e.emitter=null,this.resetField(e.field),e.actions=null},reset:function(){var e=this._elements;o.keys(e).map(o.pick.bind(o,e)).forEach(this.resetElement.bind(this)),this._elements={}}})},{events:14,protean:21,underscore:25}],5:[function(){var e=Array.prototype;"function"!=typeof e.map&&(e.map=function(e,t){for(var n,r,i=this,o=i.length,u=0,s=[];o>u;u++)n=i[u],r=e.call(t||null,n,u,i),s.push(r);return s}),"function"!=typeof e.forEach&&(e.forEach=e.each=function(e,t){this.map(e,t)}),"function"!=typeof e.filter&&(e.filter=function(e,t){var n=[];return this.map(function(r,i,o){e.call(t||null,r,i,o)&&n.push(r)}),n}),e.reduce||(e.reduce=function(e){var t,n=Object(this),r=n.length,i=0;if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");if(2===arguments.length)t=arguments[1];else{for(;r>i&&!(i in n);)i++;if(i>=r)throw new TypeError("Reduce of empty array with no initial value");t=n[i++]}for(;r>i;i++)i in n&&(t=e(t,n[i],i,n));return t})},{}],6:[function(e,t){var n="undefined"!=typeof n?n:{},r=e("underscore");n.log||(n.log=n.println?r.bind(n.println,n):"function"==typeof alert?alert:function(){},n.log("Console extensions loaded")),t.exports=n},{underscore:25}],7:[function(){var e=Function.prototype,t=Array.prototype.slice;"function"!=typeof e.bind&&(e.bind=function(e){var n=t.call(arguments,1),r=this;return function(){return r.apply(e,n.concat(t.call(arguments)))}})},{}],8:[function(e){e("./function"),e("./object"),e("./array"),e("./console")},{"./array":5,"./console":6,"./function":7,"./object":9}],9:[function(){var e;"function"!=typeof Object.keys&&(Object.keys=function(e){var t,n=[];for(t in e)n.push(t);return n}),Object.defineProperty||(Object.defineProperty=function(e,t,n){var r=n.value,i=n.get,o=n.set;return i||o?(i&&e.__defineGetter__(t,i),o&&e.__defineSetter__(t,o)):e[t]=r,e}),Object.defineProperties||(Object.defineProperties=function(e,t){var n;for(n in t)Object.defineProperty(e,n,t[n]);return e}),Object.create||(e=function(){},Object.create=function(t,n){var r;return e.prototype=t,r=new e,n&&Object.defineProperties(r,n),r})},{}],10:[function(e){e("./ext"),e("./document");var t=e("./character");character=new t},{"./character":2,"./document":4,"./ext":8}],11:[function(e,t){function n(e){n.superclass.call(this),r.augment(this,e||{})}var r=e("protean"),i=e("events").EventEmitter;t.exports=r.inherit(i,n)},{events:14,protean:21}],12:[function(e,t){function n(e){n.superclass.call(this,{parent:e}),e.once("init",this.init.bind(this))}var r=e("./model");t.exports=r.extend(n,{init:function(){var e=this.parent,t=e.abilities,n=this.update.bind(this);t.on("bonus-changed",n),e.classes.on("proficiency-bonus",this.updateAll.bind(this)),t.keys.forEach(function(r){var i=e.abilities[r].abbr,o=i+"SaveProf";document.on(o,"click",function(){n(r,t[r].bonus)})}),this.updateAll()},updateAll:function(){var e=this.parent.abilities,t=this.update.bind(this);e.keys.forEach(function(n){t(n,e[n].bonus)})},update:function(e,t){var n=this.parent.abilities[e].abbr,r=document.getField(n+"SaveProf"),i=document.getField(n+"Save"),o=r.isBoxChecked(0),u=this.parent.classes.proficiency||0,s=t+(o?u:0);i.value=(s>=0?"+":"-")+s,this.emit("changed",e,s)}})},{"./model":11}],13:[function(e,t){function n(e){n.superclass.call(this,i.keys(o).map(function(e){return i.extend({name:e},o[e])}).reduce(function(e,t){return e[t.name]=i.extend({total:0},t),e},{parent:e})),e.once("init",this.init.bind(this))}var r=e("./model"),i=e("underscore"),o={Acrobatics:{ability:"dexterity"},AnimalHandling:{ability:"wisdom"},Arcana:{ability:"intelligence"},Athletics:{ability:"strength"},Deception:{ability:"charisma"},History:{ability:"intelligence"},Insight:{ability:"wisdom"},Intimidation:{ability:"charisma"},Investigation:{ability:"intelligence"},Medicine:{ability:"wisdom"},Nature:{ability:"intelligence"},Perception:{ability:"wisdom"},Performance:{ability:"charisma"},Persuasion:{ability:"charisma"},Religion:{ability:"intelligence"},SleightOfHand:{ability:"dexterity"},Stealth:{ability:"dexterity"},Survival:{ability:"wisdom"}};t.exports=r.extend(n,{get keys(){return i.keys(o)},init:function(){var e=this.parent,t=e.abilities,n=this.keys,r=this.update.bind(this);e.classes.on("proficiency-bonus",this.updateAll.bind(this)),t.on("bonus-changed",function(e,t){n.forEach(function(n){o[n].ability===e&&r(n,t)})}),this.keys.forEach(function(e){var n=e+"Prof";document.on(n,"click",function(){r(e,t[o[e].ability].bonus)})}),this.updateAll()},updateAll:function(){var e=this.parent.abilities,t=this.update.bind(this);this.keys.forEach(function(n){var r=o[n].ability;t(n,e[r].bonus)})},update:function(e,t){var n=document.getField(e+"Prof"),r=document.getField(e),i=n.isBoxChecked(0),o=this.parent.classes.proficiency||0,u=this[e],s=u&&u.total,a=t+(i?o:0);return r?void((""===r.value||s!==a)&&(this[e].total=a,r.value=(a>=0?"+":"-")+a,this.emit("changed",e,a))):void console.println("COULD NOT LOCATE SKILL FIELD: "+e)}})},{"./model":11,underscore:25}],14:[function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function u(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,s,a,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],u(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,s=new Array(i-1),a=1;i>a;a++)s[a-1]=arguments[a];n.apply(this,s)}else if(o(n)){for(i=arguments.length,s=new Array(i-1),a=1;i>a;a++)s[a-1]=arguments[a];for(c=n.slice(),i=c.length,a=0;i>a;a++)c[a].apply(this,s)}return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned){var i;i=u(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,u,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],u=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(s=u;s-->0;)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],15:[function(e,t){function n(){return r.rest(arguments,1).reduce(function(e,t){var n,r,o,u;for(n in t)e.hasOwnProperty(n)||(r=i&&t.__lookupGetter__(n),o=i&&t.__lookupSetter__(n),r||o?(u=u||{},u[n]={get:r,set:o,configurable:!0,enumerable:!0}):e[n]=t[n]);return u&&Object.defineProperties(e,u),e},arguments[0])}var r=e("underscore"),i=Boolean(Object.prototype.__lookupGetter__);t.exports=n},{underscore:25}],16:[function(e,t){t.exports=e("./inherit").bind(null,Object)},{"./inherit":22}],17:[function(e,t){var n=e("underscore");t.exports=function(){return n.reduce(arguments,function(e,t,n){return e[t]=n+1,e},{})}},{underscore:25}],18:[function(e,t){function n(){var e=i.flatten(i.rest(arguments,0)).reduce(function(e,t){var n;return i.isFunction(t)?(n={},n.fn=t,e.push(n)):(n=e[e.length-1],n.args=n.args||[null],n.args.push(t)),e},[]).map(function(e){return r.apply(e.fn,e.args)});return function(){for(var t,n=i.rest(arguments,0),r=e.length,o=0;r>o;o++)t=e[o],n=t[i.isArray(n)?"apply":"call"](null,n);return n}}var r=Function.prototype.bind,i=e("underscore");t.exports=n},{underscore:25}],19:[function(e,t){for(var n=[],r=0;256>r;r++)n[r]=(16>r?"0":"")+r.toString(16);t.exports=function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return n[255&e]+n[e>>8&255]+n[e>>16&255]+n[e>>24&255]+"-"+n[255&t]+n[t>>8&255]+"-"+n[t>>16&15|64]+n[t>>24&255]+"-"+n[63&r|128]+n[r>>8&255]+"-"+n[r>>16&255]+n[r>>24&255]+n[255&i]+n[i>>8&255]+n[i>>16&255]+n[i>>24&255]}},{}],20:[function(e,t){var n=e("underscore");t.exports=function(){var e=n.rest(arguments,0);return n.object(e,e)}},{underscore:25}],21:[function(e,t){t.exports={inherit:e("./inherit"),classify:e("./classify"),augment:e("./augment"),hashify:e("./hashify"),enumerate:e("./enumerate"),instantiate:e("./instantiate"),guid:e("./guid"),invoke:e("./invoke"),execute:e("./execute")}},{"./augment":15,"./classify":16,"./enumerate":17,"./execute":18,"./guid":19,"./hashify":20,"./inherit":22,"./instantiate":23,"./invoke":24}],22:[function(e,t){function n(e,t,o,u){var s,a,c;return arguments.length<4&&"function"!=typeof t&&(u=o,o=t,t=null),s=o&&o.hasOwnProperty("constructor"),t="function"==typeof t&&t||s&&o.constructor||function(){e.apply(this,arguments)},a=e.prototype,t.prototype=c=r(Object.create(a),t.prototype),u=u||{},o&&(delete o.constructor,r(c,o)),u.constructor={value:t},Object.defineProperties(c,u),t.superclass=e,t.superproto=a,t.extend||(t.extend=n.bind(t,t)),t.extended=t.extended?i.wrap(t.extended.bind(t),function(t,n){e.extended&&e.extended(n),t(n)}):e.extended,e.extended&&e.extended(t),t}var r=e("./augment"),i=e("underscore");t.exports=n},{"./augment":15,underscore:25}],23:[function(e,t){e("underscore");t.exports=function(e,t){var n=Object.create(e.prototype);return e.apply(n,t||[]),n}},{underscore:25}],24:[function(e,t){function n(e){var t=r.rest(arguments,1);return function(n){return n[e].apply(n,t)}}var r=e("underscore");t.exports=n},{underscore:25}],25:[function(e,t,n){(function(){var e=this,r=e._,i=Array.prototype,o=Object.prototype,u=Function.prototype,s=i.push,a=i.slice,c=i.concat,l=o.toString,f=o.hasOwnProperty,h=Array.isArray,p=Object.keys,d=u.bind,v=function(e){return e instanceof v?e:this instanceof v?void(this._wrapped=e):new v(e)};"undefined"!=typeof n?("undefined"!=typeof t&&t.exports&&(n=t.exports=v),n._=v):e._=v,v.VERSION="1.7.0";var m=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,o){return e.call(t,n,r,i,o)}}return function(){return e.apply(t,arguments)}};v.iteratee=function(e,t,n){return null==e?v.identity:v.isFunction(e)?m(e,t,n):v.isObject(e)?v.matches(e):v.property(e)},v.each=v.forEach=function(e,t,n){if(null==e)return e;t=m(t,n);var r,i=e.length;if(i===+i)for(r=0;i>r;r++)t(e[r],r,e);else{var o=v.keys(e);for(r=0,i=o.length;i>r;r++)t(e[o[r]],o[r],e)}return e},v.map=v.collect=function(e,t,n){if(null==e)return[];t=v.iteratee(t,n);for(var r,i=e.length!==+e.length&&v.keys(e),o=(i||e).length,u=Array(o),s=0;o>s;s++)r=i?i[s]:s,u[s]=t(e[r],r,e);return u};var g="Reduce of empty array with no initial value";v.reduce=v.foldl=v.inject=function(e,t,n,r){null==e&&(e=[]),t=m(t,r,4);var i,o=e.length!==+e.length&&v.keys(e),u=(o||e).length,s=0;if(arguments.length<3){if(!u)throw new TypeError(g);n=e[o?o[s++]:s++]}for(;u>s;s++)i=o?o[s]:s,n=t(n,e[i],i,e);return n},v.reduceRight=v.foldr=function(e,t,n,r){null==e&&(e=[]),t=m(t,r,4);var i,o=e.length!==+e.length&&v.keys(e),u=(o||e).length;if(arguments.length<3){if(!u)throw new TypeError(g);n=e[o?o[--u]:--u]}for(;u--;)i=o?o[u]:u,n=t(n,e[i],i,e);return n},v.find=v.detect=function(e,t,n){var r;return t=v.iteratee(t,n),v.some(e,function(e,n,i){return t(e,n,i)?(r=e,!0):void 0}),r},v.filter=v.select=function(e,t,n){var r=[];return null==e?r:(t=v.iteratee(t,n),v.each(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r)},v.reject=function(e,t,n){return v.filter(e,v.negate(v.iteratee(t)),n)},v.every=v.all=function(e,t,n){if(null==e)return!0;t=v.iteratee(t,n);var r,i,o=e.length!==+e.length&&v.keys(e),u=(o||e).length;for(r=0;u>r;r++)if(i=o?o[r]:r,!t(e[i],i,e))return!1;return!0},v.some=v.any=function(e,t,n){if(null==e)return!1;t=v.iteratee(t,n);var r,i,o=e.length!==+e.length&&v.keys(e),u=(o||e).length;for(r=0;u>r;r++)if(i=o?o[r]:r,t(e[i],i,e))return!0;return!1},v.contains=v.include=function(e,t){return null==e?!1:(e.length!==+e.length&&(e=v.values(e)),v.indexOf(e,t)>=0)},v.invoke=function(e,t){var n=a.call(arguments,2),r=v.isFunction(t);return v.map(e,function(e){return(r?t:e[t]).apply(e,n)})},v.pluck=function(e,t){return v.map(e,v.property(t))},v.where=function(e,t){return v.filter(e,v.matches(t))},v.findWhere=function(e,t){return v.find(e,v.matches(t))},v.max=function(e,t,n){var r,i,o=-1/0,u=-1/0;if(null==t&&null!=e){e=e.length===+e.length?e:v.values(e);for(var s=0,a=e.length;a>s;s++)r=e[s],r>o&&(o=r)}else t=v.iteratee(t,n),v.each(e,function(e,n,r){i=t(e,n,r),(i>u||i===-1/0&&o===-1/0)&&(o=e,u=i)});return o},v.min=function(e,t,n){var r,i,o=1/0,u=1/0;if(null==t&&null!=e){e=e.length===+e.length?e:v.values(e);for(var s=0,a=e.length;a>s;s++)r=e[s],o>r&&(o=r)}else t=v.iteratee(t,n),v.each(e,function(e,n,r){i=t(e,n,r),(u>i||1/0===i&&1/0===o)&&(o=e,u=i)});return o},v.shuffle=function(e){for(var t,n=e&&e.length===+e.length?e:v.values(e),r=n.length,i=Array(r),o=0;r>o;o++)t=v.random(0,o),t!==o&&(i[o]=i[t]),i[t]=n[o];return i},v.sample=function(e,t,n){return null==t||n?(e.length!==+e.length&&(e=v.values(e)),e[v.random(e.length-1)]):v.shuffle(e).slice(0,Math.max(0,t))},v.sortBy=function(e,t,n){return t=v.iteratee(t,n),v.pluck(v.map(e,function(e,n,r){return{value:e,index:n,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return e.index-t.index}),"value")};var y=function(e){return function(t,n,r){var i={};return n=v.iteratee(n,r),v.each(t,function(r,o){var u=n(r,o,t);e(i,r,u)}),i}};v.groupBy=y(function(e,t,n){v.has(e,n)?e[n].push(t):e[n]=[t]}),v.indexBy=y(function(e,t,n){e[n]=t}),v.countBy=y(function(e,t,n){v.has(e,n)?e[n]++:e[n]=1}),v.sortedIndex=function(e,t,n,r){n=v.iteratee(n,r,1);for(var i=n(t),o=0,u=e.length;u>o;){var s=o+u>>>1;n(e[s])<i?o=s+1:u=s}return o},v.toArray=function(e){return e?v.isArray(e)?a.call(e):e.length===+e.length?v.map(e,v.identity):v.values(e):[]},v.size=function(e){return null==e?0:e.length===+e.length?e.length:v.keys(e).length},v.partition=function(e,t,n){t=v.iteratee(t,n);var r=[],i=[];return v.each(e,function(e,n,o){(t(e,n,o)?r:i).push(e)}),[r,i]},v.first=v.head=v.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:0>t?[]:a.call(e,0,t)},v.initial=function(e,t,n){return a.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},v.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:a.call(e,Math.max(e.length-t,0))},v.rest=v.tail=v.drop=function(e,t,n){return a.call(e,null==t||n?1:t)},v.compact=function(e){return v.filter(e,v.identity)};var b=function(e,t,n,r){if(t&&v.every(e,v.isArray))return c.apply(r,e);for(var i=0,o=e.length;o>i;i++){var u=e[i];v.isArray(u)||v.isArguments(u)?t?s.apply(r,u):b(u,t,n,r):n||r.push(u)}return r};v.flatten=function(e,t){return b(e,t,!1,[])},v.without=function(e){return v.difference(e,a.call(arguments,1))},v.uniq=v.unique=function(e,t,n,r){if(null==e)return[];v.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=v.iteratee(n,r));for(var i=[],o=[],u=0,s=e.length;s>u;u++){var a=e[u];if(t)u&&o===a||i.push(a),o=a;else if(n){var c=n(a,u,e);v.indexOf(o,c)<0&&(o.push(c),i.push(a))}else v.indexOf(i,a)<0&&i.push(a)}return i},v.union=function(){return v.uniq(b(arguments,!0,!0,[]))},v.intersection=function(e){if(null==e)return[];for(var t=[],n=arguments.length,r=0,i=e.length;i>r;r++){var o=e[r];if(!v.contains(t,o)){for(var u=1;n>u&&v.contains(arguments[u],o);u++);u===n&&t.push(o)}}return t},v.difference=function(e){var t=b(a.call(arguments,1),!0,!0,[]);return v.filter(e,function(e){return!v.contains(t,e)})},v.zip=function(e){if(null==e)return[];for(var t=v.max(arguments,"length").length,n=Array(t),r=0;t>r;r++)n[r]=v.pluck(arguments,r);return n},v.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},v.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=v.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}for(;i>r;r++)if(e[r]===t)return r;return-1},v.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=e.length;for("number"==typeof n&&(r=0>n?r+n+1:Math.min(r,n+1));--r>=0;)if(e[r]===t)return r;return-1},v.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=n||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),o=0;r>o;o++,e+=n)i[o]=e;return i};var _=function(){};v.bind=function(e,t){var n,r;if(d&&e.bind===d)return d.apply(e,a.call(arguments,1));if(!v.isFunction(e))throw new TypeError("Bind must be called on a function");return n=a.call(arguments,2),r=function(){if(!(this instanceof r))return e.apply(t,n.concat(a.call(arguments)));_.prototype=e.prototype;var i=new _;_.prototype=null;var o=e.apply(i,n.concat(a.call(arguments)));return v.isObject(o)?o:i}},v.partial=function(e){var t=a.call(arguments,1);return function(){for(var n=0,r=t.slice(),i=0,o=r.length;o>i;i++)r[i]===v&&(r[i]=arguments[n++]);for(;n<arguments.length;)r.push(arguments[n++]);return e.apply(this,r)}},v.bindAll=function(e){var t,n,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(t=1;r>t;t++)n=arguments[t],e[n]=v.bind(e[n],e);return e},v.memoize=function(e,t){var n=function(r){var i=n.cache,o=t?t.apply(this,arguments):r;return v.has(i,o)||(i[o]=e.apply(this,arguments)),i[o]};return n.cache={},n},v.delay=function(e,t){var n=a.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},v.defer=function(e){return v.delay.apply(v,[e,1].concat(a.call(arguments,1)))},v.throttle=function(e,t,n){var r,i,o,u=null,s=0;n||(n={});var a=function(){s=n.leading===!1?0:v.now(),u=null,o=e.apply(r,i),u||(r=i=null)};return function(){var c=v.now();s||n.leading!==!1||(s=c);var l=t-(c-s);return r=this,i=arguments,0>=l||l>t?(clearTimeout(u),u=null,s=c,o=e.apply(r,i),u||(r=i=null)):u||n.trailing===!1||(u=setTimeout(a,l)),o}},v.debounce=function(e,t,n){var r,i,o,u,s,a=function(){var c=v.now()-u;t>c&&c>0?r=setTimeout(a,t-c):(r=null,n||(s=e.apply(o,i),r||(o=i=null)))};return function(){o=this,i=arguments,u=v.now();var c=n&&!r;return r||(r=setTimeout(a,t)),c&&(s=e.apply(o,i),o=i=null),s}},v.wrap=function(e,t){return v.partial(t,e)},v.negate=function(e){return function(){return!e.apply(this,arguments)}},v.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},v.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},v.before=function(e,t){var n;return function(){return--e>0?n=t.apply(this,arguments):t=null,n}},v.once=v.partial(v.before,2),v.keys=function(e){if(!v.isObject(e))return[];if(p)return p(e);var t=[];for(var n in e)v.has(e,n)&&t.push(n);return t},v.values=function(e){for(var t=v.keys(e),n=t.length,r=Array(n),i=0;n>i;i++)r[i]=e[t[i]];return r},v.pairs=function(e){for(var t=v.keys(e),n=t.length,r=Array(n),i=0;n>i;i++)r[i]=[t[i],e[t[i]]];return r},v.invert=function(e){for(var t={},n=v.keys(e),r=0,i=n.length;i>r;r++)t[e[n[r]]]=n[r];return t},v.functions=v.methods=function(e){var t=[];for(var n in e)v.isFunction(e[n])&&t.push(n);return t.sort()},v.extend=function(e){if(!v.isObject(e))return e;for(var t,n,r=1,i=arguments.length;i>r;r++){t=arguments[r];for(n in t)f.call(t,n)&&(e[n]=t[n])}return e},v.pick=function(e,t,n){var r,i={};if(null==e)return i;if(v.isFunction(t)){t=m(t,n);for(r in e){var o=e[r];t(o,r,e)&&(i[r]=o)}}else{var u=c.apply([],a.call(arguments,1));e=new Object(e);for(var s=0,l=u.length;l>s;s++)r=u[s],r in e&&(i[r]=e[r])}return i},v.omit=function(e,t,n){if(v.isFunction(t))t=v.negate(t);else{var r=v.map(c.apply([],a.call(arguments,1)),String);t=function(e,t){return!v.contains(r,t)}}return v.pick(e,t,n)},v.defaults=function(e){if(!v.isObject(e))return e;for(var t=1,n=arguments.length;n>t;t++){var r=arguments[t];for(var i in r)void 0===e[i]&&(e[i]=r[i])}return e},v.clone=function(e){return v.isObject(e)?v.isArray(e)?e.slice():v.extend({},e):e},v.tap=function(e,t){return t(e),e};var x=function(e,t,n,r){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof v&&(e=e._wrapped),t instanceof v&&(t=t._wrapped);var i=l.call(e);if(i!==l.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=n.length;o--;)if(n[o]===e)return r[o]===t;var u=e.constructor,s=t.constructor;if(u!==s&&"constructor"in e&&"constructor"in t&&!(v.isFunction(u)&&u instanceof u&&v.isFunction(s)&&s instanceof s))return!1;n.push(e),r.push(t);var a,c;if("[object Array]"===i){if(a=e.length,c=a===t.length)for(;a--&&(c=x(e[a],t[a],n,r)););}else{var f,h=v.keys(e);if(a=h.length,c=v.keys(t).length===a)for(;a--&&(f=h[a],c=v.has(t,f)&&x(e[f],t[f],n,r)););}return n.pop(),r.pop(),c};v.isEqual=function(e,t){return x(e,t,[],[])},v.isEmpty=function(e){if(null==e)return!0;if(v.isArray(e)||v.isString(e)||v.isArguments(e))return 0===e.length;for(var t in e)if(v.has(e,t))return!1;return!0},v.isElement=function(e){return!(!e||1!==e.nodeType)},v.isArray=h||function(e){return"[object Array]"===l.call(e)},v.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},v.each(["Arguments","Function","String","Number","Date","RegExp"],function(e){v["is"+e]=function(t){return l.call(t)==="[object "+e+"]"}}),v.isArguments(arguments)||(v.isArguments=function(e){return v.has(e,"callee")}),"function"!=typeof/./&&(v.isFunction=function(e){return"function"==typeof e||!1}),v.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},v.isNaN=function(e){return v.isNumber(e)&&e!==+e},v.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===l.call(e)},v.isNull=function(e){return null===e},v.isUndefined=function(e){return void 0===e},v.has=function(e,t){return null!=e&&f.call(e,t)},v.noConflict=function(){return e._=r,this},v.identity=function(e){return e},v.constant=function(e){return function(){return e}},v.noop=function(){},v.property=function(e){return function(t){return t[e]}},v.matches=function(e){var t=v.pairs(e),n=t.length;return function(e){if(null==e)return!n;e=new Object(e);for(var r=0;n>r;r++){var i=t[r],o=i[0];if(i[1]!==e[o]||!(o in e))return!1}return!0}},v.times=function(e,t,n){var r=Array(Math.max(0,e));t=m(t,n,1);for(var i=0;e>i;i++)r[i]=t(i);return r},v.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},v.now=Date.now||function(){return(new Date).getTime()};var w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},j=v.invert(w),k=function(e){var t=function(t){return e[t]},n="(?:"+v.keys(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(i,t):e}};v.escape=k(w),v.unescape=k(j),v.result=function(e,t){if(null==e)return void 0;var n=e[t];return v.isFunction(n)?e[t]():n};var E=0;v.uniqueId=function(e){var t=++E+"";return e?e+t:t},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,O={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\u2028|\u2029/g,F=function(e){return"\\"+O[e]};v.template=function(e,t,n){!t&&n&&(t=n),t=v.defaults({},t,v.templateSettings);var r=RegExp([(t.escape||A).source,(t.interpolate||A).source,(t.evaluate||A).source].join("|")+"|$","g"),i=0,o="__p+='";e.replace(r,function(t,n,r,u,s){return o+=e.slice(i,s).replace(L,F),i=s+t.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":u&&(o+="';\n"+u+"\n__p+='"),t}),o+="';\n",t.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var u=new Function(t.variable||"obj","_",o)}catch(s){throw s.source=o,s}var a=function(e){return u.call(this,e,v)},c=t.variable||"obj";return a.source="function("+c+"){\n"+o+"}",a},v.chain=function(e){var t=v(e);return t._chain=!0,t};var S=function(e){return this._chain?v(e).chain():e};v.mixin=function(e){v.each(v.functions(e),function(t){var n=v[t]=e[t];v.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),S.call(this,n.apply(v,e))}})},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];v.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],S.call(this,n)}}),v.each(["concat","join","slice"],function(e){var t=i[e];v.prototype[e]=function(){return S.call(this,t.apply(this._wrapped,arguments))}}),v.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return v})}).call(this)},{}]},{},[10]);